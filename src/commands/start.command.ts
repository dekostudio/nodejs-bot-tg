import { Telegraf } from "telegraf";
import { IBotContext } from "../context/context.interface";
import { Command } from "./command.class";

export class StartCommand extends Command {
  constructor(bot: Telegraf<IBotContext>) {
    super(bot);
  }

  descriptionProject(ctx: { reply: (arg0: string) => void; }): void {
    ctx.reply(`–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–ø–∏—à–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç, —É—Ç–æ—á–Ω–∏—Ç–µ —Å—Ä–æ–∫–∏, –±—é–¥–∂–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é\n\n–ü—Ä–∏–º–µ—Ä:\n\n–ò–º—è –ø—Ä–æ–µ–∫—Ç–∞: (–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞)\n–ó–∞–∫–∞–∑—á–∏–∫: (–ò–º—è –∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—á–∏–∫–∞)\n–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞: (–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ü–µ–ª–µ–π –∏ –æ–∂–∏–¥–∞–µ–º—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞)\n–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è: (–û–ø–∏—Å–∞–Ω–∏–µ –≤–∞—à–µ–π —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏, –≤–∫–ª—é—á–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)\n–û—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:\n\n–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è: (–ü–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω—ã –≤ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)\n–î–∏–∑–∞–π–Ω –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: (–£–∫–∞–∂–∏—Ç–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –¥–∏–∑–∞–π–Ω–∞ –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, –≤–∫–ª—é—á–∞—è —Ü–≤–µ—Ç–æ–≤—É—é –ø–∞–ª–∏—Ç—Ä—É, —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å—Ç—Ä–∞–Ω–∏—Ü –∏ —Ç. –¥.)\n–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è: (–£–∫–∞–∂–∏—Ç–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å)\n–°—Ä–æ–∫–∏ –∏ –±—é–¥–∂–µ—Ç:\n\n–°—Ä–æ–∫–∏: (–£–∫–∞–∂–∏—Ç–µ –¥–∞—Ç—É –Ω–∞—á–∞–ª–∞ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞)\n–ë—é–¥–∂–µ—Ç: (–£–∫–∞–∂–∏—Ç–µ –æ–±—â–∏–π –±—é–¥–∂–µ—Ç –Ω–∞ –ø—Ä–æ–µ–∫—Ç)\n–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:\n\n–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã: (–£–∫–∞–∂–∏—Ç–µ –≤–∞—à–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã –∏ –∏—Ö –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)\n–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞: (–õ—é–±—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏–ª–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –±—ã–ª–∏ —É—á—Ç–µ–Ω—ã –≤—ã—à–µ)`);
  }

  handle(): void {
    this.bot.start((ctx) => {
      const replyMarkup = {
        inline_keyboard: [
          [
            { text: "–ó–∞–ø–æ–ª–Ω–∏—Ç—å –±—Ä–∏—Ñ", callback_data: "into_brief" },
            { text: "–ü–æ–¥–¥–µ—Ä–∂–∫–∞", callback_data: "support" },
          ],
          [{ text: "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", callback_data: "information" }],
          [
            { text: "–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç", url: "telegraf.js.org" },
            { text: "–ü–µ—Ä–µ–π—Ç–∏ –≤ —Ç–µ–ª–µ–≥—Ä–∞–º –≥—Ä—É–ø–ø—É", url: "t.me/dekostudio" },
          ],
        ],
      };

      ctx.reply(`–ü—Ä–∏–≤–µ—Ç! üëã\n\n–Ø - –±–æ—Ç –æ—Ç —Å—Ç—É–¥–∏–∏ –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ DekoStudio.\n\n–ú—ã –∑–¥–µ—Å—å, —á—Ç–æ–±—ã –ø–æ–º–æ—á—å –≤–∞–º —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏ –æ –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ, —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–∞–π—Ç–æ–≤, –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ –¥—Ä—É–≥–∏—Ö –æ–Ω–ª–∞–π–Ω-–ø—Ä–æ–µ–∫—Ç–∞—Ö. –ù–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –∑–∞–¥–∞–≤–∞—Ç—å –ª—é–±—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ—Å–∏—Ç—å —Å–æ–≤–µ—Ç–∞, –∏ –º—ã –ø–æ—Å—Ç–∞—Ä–∞–µ–º—Å—è –≤–∞–º –ø–æ–º–æ—á—å.\n\n–¢–∞–∫–∂–µ —É –Ω–∞—Å –µ—Å—Ç—å –º–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π, —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –ø—Ä–æ–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–º–∏ –º—ã –≥–æ—Ä–¥–∏–º—Å—è, –∏ –º—ã –≥–æ—Ç–æ–≤—ã –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —ç—Ç–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π —Å –≤–∞–º–∏. –ö–∞–∫ –º—ã –º–æ–∂–µ–º –±—ã—Ç—å –≤–∞–º –ø–æ–ª–µ–∑–Ω—ã —Å–µ–≥–æ–¥–Ω—è? üöÄüíª`, { reply_markup: replyMarkup });
    });

    this.bot.action("information", (ctx): void => {
      const informationText = `–ú—ã –∑–¥–µ—Å—å, —á—Ç–æ–±—ã –ø–æ–º–æ—á—å –≤–∞–º –≤–æ–ø–ª–æ—Ç–∏—Ç—å –≤ –∂–∏–∑–Ω—å –≤–∞—à–∏ –æ–Ω–ª–∞–π–Ω-–ø—Ä–æ–µ–∫—Ç—ã –∏ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã –æ –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ, –¥–∏–∑–∞–π–Ω–µ, –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö –∏ –º–Ω–æ–≥–æ–º –¥—Ä—É–≥–æ–º.\n\nüåê –ù–∞—à–∞ —ç–∫—Å–ø–µ—Ä—Ç–∏–∑–∞ –≤–∫–ª—é—á–∞–µ—Ç:\n\nüñ• –í–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É\n\nüì± –ú–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è\n\nüí° UI/UX –î–∏–∑–∞–π–Ω\n\nüöÄ SEO –∏ –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥\n\nüíª –¢–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É\n\n–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã, –∏–¥–µ–∏, –∏–ª–∏ –≤—ã –ø—Ä–æ—Å—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ –æ –Ω–∞—à–µ–π —Å—Ç—É–¥–∏–∏, –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–∞–º. –ú—ã –≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å –≤–∞–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–∞—à–∏ –ø—Ä–æ–µ–∫—Ç—ã –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ!\n\n–ß–µ–º –º—ã –º–æ–∂–µ–º –≤–∞–º –ø–æ–º–æ—á—å —Å–µ–≥–æ–¥–Ω—è? üí°`

      const replyMarkup = {
        inline_keyboard: [
          [{ text: "–ö—Ç–æ –º—ã ?", callback_data: "12" }],
          [{ text: "–ù–∞—à–∏ –ø—Ä–∏–µ–º—É—â–µ—Å—Ç–≤–∞ ?", callback_data: "13" }],
        ],
      };

      ctx.reply(informationText, { reply_markup: replyMarkup });
    });

    this.bot.action("into_brief", (ctx): void => {
      const replyMarkup = {
        inline_keyboard: [
          [{ text: "UX - –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ", callback_data: "ux-choose" }],
          [{ text: "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç - –ú–∞–≥–∞–∑–∏–Ω", callback_data: "onlineshop-choose" }],
          [{ text: "–õ–µ–Ω–¥–∏–Ω–≥", callback_data: "landing-choose" }],
          [{ text: "–°–∞–π—Ç", callback_data: "website-choose" }],
        ],
      };

      ctx.reply("–ö–∞–∫–∏–µ —É—Å–ª—É–≥–∏ –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã?", { reply_markup: replyMarkup });
    });

    this.bot.action("ux-choose", (ctx): void => {
      this.descriptionProject(ctx)
      ctx.session.awaitingDescription = true;
      ctx.session.selectedCategory = "UX - –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ";
    });

    this.bot.action("onlineshop-choose", (ctx): void => {
      this.descriptionProject(ctx)
      ctx.session.awaitingDescription = true;
      ctx.session.selectedCategory = "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç - –ú–∞–≥–∞–∑–∏–Ω";
    });

    this.bot.action("landing-choose", (ctx): void => {
      this.descriptionProject(ctx)
      ctx.session.awaitingDescription = true;
      ctx.session.selectedCategory = "–õ–µ–Ω–¥–∏–Ω–≥";
    });

    this.bot.action("website-choose", (ctx): void => {
      this.descriptionProject(ctx)
      ctx.session.awaitingDescription = true;
      ctx.session.selectedCategory = "–°–∞–π—Ç";
    });

    this.bot.on("text", (ctx): void => {
      if (ctx.session.awaitingDescription) {
        const userId = ctx.from.id;
        const username = ctx.from.username;
        const description = ctx.message.text;
        const category = ctx.session.selectedCategory;

        this.sendToYourself(userId, username, description, category);
        
        ctx.session.awaitingDescription = false;
        ctx.session.selectedCategory = "";

        ctx.reply(`üíº –î–∞–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –±—ã–ª–∞ –ø–µ—Ä–µ–¥–∞–Ω–∞ –Ω–∞—à–∏–º —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º, —Å–∫–æ—Ä–æ –æ–Ω–∏ –≤–∞–º –æ—Ç–≤–µ—Ç—è—Ç ‚úâÔ∏è \n\n–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∏ –∫–∞–∫–∏–µ - —Ç–æ –ø—Ä–æ–±–ª–µ–º—ã, —Ç–æ –∑–≤–æ–Ω–∏—Ç–µ –ø–æ –Ω–æ–º–µ—Ä—É üìû\n+7 (988) 175-11-12`);
      }
    });
  }

  private sendToYourself(userId: number, username: string | undefined, description: string, category: string): void {
    const sendInfo = `üöÄ –£ –Ω–∞—Å –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑!\n\nüåê –ü—Ä–∏—Å—Ç—É–ø–∞–µ–º –∫ —Ä–∞–±–æ—Ç–µ! üíº\n\n–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è üë§\n\nusername: ${username}\nid: ${userId}\n\n–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–µ–∫—Ç–µ üìñ\n\n–í—ã–±—Ä–∞–Ω–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è: ${category}\n–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞: ${description}`
    this.bot.telegram.sendMessage(process.env.USER_ID as string | number, sendInfo);
  }
}
